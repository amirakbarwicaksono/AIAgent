# ==========================================================
# Visualisasi Dataset Rute Jakarta
# ----------------------------------------------------------
# Menampilkan analisis grafis dari data hasil simulasi AI Traffic Logger
# ==========================================================

import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

# Konfigurasi tampilan plot
plt.style.use('seaborn-v0_8-whitegrid')
sns.set_palette("Set2")

# Membaca dataset
DATA_FILE = "dataset_rute_jakarta.csv"
df = pd.read_csv(DATA_FILE)

print("=== Dataset berhasil dimuat ===")
print(df.head())

# Pastikan kolom waktu numerik
df["Estimasi_Waktu_menit"] = pd.to_numeric(df["Estimasi_Waktu_menit"], errors='coerce')

# --- Visualisasi rata-rata waktu tempuh per algoritma ---
plt.figure(figsize=(8,5))
sns.barplot(
    data=df,
    x="Algoritma",
    y="Estimasi_Waktu_menit",
    estimator="mean",
    errorbar=None
)
plt.title("Rata-Rata Estimasi Waktu Tempuh per Algoritma", fontsize=13)
plt.xlabel("Algoritma")
plt.ylabel("Rata-rata Waktu (menit)")
plt.tight_layout()
plt.show()

# --- Pengaruh kondisi jalan terhadap waktu tempuh ---
plt.figure(figsize=(8,5))
sns.boxplot(
    data=df,
    x="Kondisi_Jalan",
    y="Estimasi_Waktu_menit",
    hue="Algoritma"
)
plt.title("Distribusi Waktu Tempuh Berdasarkan Kondisi Jalan", fontsize=13)
plt.xlabel("Kondisi Jalan")
plt.ylabel("Waktu Tempuh (menit)")
plt.legend(title="Algoritma")
plt.tight_layout()
plt.show()

# --- Pengaruh cuaca terhadap waktu tempuh ---
plt.figure(figsize=(8,5))
sns.barplot(
    data=df,
    x="Cuaca",
    y="Estimasi_Waktu_menit",
    hue="Algoritma",
    estimator="mean",
    errorbar=None
)
plt.title("Pengaruh Cuaca terhadap Estimasi Waktu Tempuh", fontsize=13)
plt.xlabel("Cuaca")
plt.ylabel("Rata-rata Waktu (menit)")
plt.tight_layout()
plt.show()

# ---  Tren waktu tempuh berdasarkan tanggal ---
if "Tanggal" in df.columns:
    plt.figure(figsize=(10,5))
    sns.lineplot(
        data=df,
        x="Tanggal",
        y="Estimasi_Waktu_menit",
        hue="Algoritma",
        marker="o"
    )
    plt.title("Tren Waktu Tempuh Harian Berdasarkan Algoritma", fontsize=13)
    plt.xlabel("Tanggal")
    plt.ylabel("Waktu Tempuh (menit)")
    plt.xticks(rotation=45)
    plt.tight_layout()
    plt.show()
